---
title: "make_rect and make_all_rects"
author: "Nathan Hebert"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{make_rect and make_all_rects}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(MVQuickGraphs)
library(corrplot)
library(psych)
```

#make_rect()

make_rect() allows the user to add rectangles to correlation plots generated by corrplot::corrplot(). One can use it to draw attention to or group correlations of interest. Rectangles can lie on the main diagonal as well as off the main diagonal. 

The correlation matrix used to generate the correlation plot must always be given. If the rectangle lies on the main diagonal, the user only needs to provide two additional parameters: rstart and rend. rstart is the variable that will serve as the vertical starting point of the rectangle, and rend is the variable that serves as the vertical ending point.

The following code creates a correlation plot using psych's Bechtoldt correlation matrix, and then adds an on-diagonal rectangle that starts at _Sentences_ and ends at _Completion_.

```{r}
corrplot(Bechtoldt)
make_rect(rstart="Sentences", rend="Completion", correlation_matrix=Bechtoldt)
```

If the rectangle of interest is off the diagonal, two additional parameters are needed: cstart, the name of the variable contained in the correlation plot that will serve as the horizontal starting point of the rectangle, and cend, the name of the variable that will serve as the horizontal ending point.

```{r}
corrplot(Bechtoldt)
make_rect(rstart="Sentences", rend="Completion", cstart = "Letter_Series", cend = "Letter_Grouping", correlation_matrix=Bechtoldt)
```

The function can be called numerous times to add multiple rectangles on one plot. It also allows you to change the width of the lines on the rectangle (with lwd), and takes additional graphical parameters supported by base R's rect() function.

```{r}
corrplot(Bechtoldt)
make_rect(rstart="Sentences", rend="Completion", correlation_matrix=Bechtoldt, lwd = 5, border = "orange")
make_rect(rstart="Flags", rend="Cards", correlation_matrix=Bechtoldt)
```

For an off-diagonal rectangle, one can set mirror = TRUE to ask the function to add the equivalent rectangle on the other side of the diagonal. If mirror = TRUE for an on-diagonal rectangle, the parameter will be ignored as on-diagonal rectangles have no mirror.

```{r}
corrplot(Bechtoldt)
make_rect(rstart="Sentences", rend="Completion", cstart = "Letter_Series", cend = "Letter_Grouping", correlation_matrix=Bechtoldt, mirror = TRUE) #off-diagonal rectangle
make_rect(rstart="Flags", rend="Cards", correlation_matrix=Bechtoldt, mirror = TRUE, border = "blue") #on-diagonal rectangle
```

#make_all_rects()

make_all_rects() allows the user to create all rectangles on a correlation plot associated with the series of cutpoints used to divide them. cutpoints is a vector, where the first element is the name of the variable that the first rectangle starts at, and the second element is the name of the variable that the second rectangle starts at, and so on. endpoint is the name of the variable that the last rectangle ends on.

```{r}
corrplot(Bechtoldt)
make_all_rects(cutpoints=c("First_Names", "Vocabulary", "Suffixes"), endpoint="Three_Higher", correlation_matrix=Bechtoldt)
```
By default, the function creates both on-diagonal and off-diagonal rectangles (which differ in colour). However, one can set ondiag or offdiag to FALSE to control the type of rectangles generated.

```{r}
corrplot(Bechtoldt)
make_all_rects(cutpoints=c("First_Names", "Vocabulary", "Suffixes", "Multiplication"), endpoint="Letter_Grouping", correlation_matrix=Bechtoldt, ondiag = FALSE) #only off-diagonal rectangles

corrplot(Bechtoldt)
make_all_rects(cutpoints=c("First_Names", "Vocabulary", "Suffixes", "Multiplication"), endpoint="Letter_Grouping", correlation_matrix=Bechtoldt, offdiag = FALSE) #only on-diagonal rectangles
```
One can customize the colour and line width of on-diagonal rectangles with col_ondiag and ondiag_width respectively. For off-diagonal rectangles, these elements can be changed with the col_offdiag and offdiag_width parameters. 

```{r}
corrplot(Bechtoldt)
make_all_rects(cutpoints=c("First_Names", "Vocabulary", "Cards"), endpoint="Three_Higher", correlation_matrix=Bechtoldt, col_offdiag = "orange", col_ondiag = "blue", ondiag_width = 3, offdiag_width = 4)
```
